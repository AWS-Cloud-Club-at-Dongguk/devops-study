# 2,3장

# 2장 개략적인 규모 추정

보편적으로 통용되는 성능 수치상에서 사고실험을 행하여 추정치를 계산하는 행위 → 설계가 요구사항에 적합한지 보기 위한 것 

## 2의 제곱수

데이터 볼륨의 최소 단위는 1byte → 8bit = ASCII 문자 1개가 차지하는 메모리 크기 

![image.png](2,3%EC%9E%A5%20270a3e9a6fbc800a9f35fc7e19a92077/image.png)

## 응답지연 값

10^-9 = 1ns

10^-6 = 1000ns = μs

10^-3 = 1000μs = 1,000,000ns 

![image.png](2,3%EC%9E%A5%20270a3e9a6fbc800a9f35fc7e19a92077/image%201.png)

### 응답 시간에 따른 결론

- 메모리는 빠르지만 디스크는 아직도 느리다
- 디스크 탐색은 가능한 피하라
- 단순한 압축 알고리즘은 빠르다
- 데이터를 인터넷으로 전송하기 전에 가능하면 압축하라
- 데이터 센터는 보통 여러 Region에 분산되어있고 선터들 간에 데이터를 주고받는 데는 시간이 걸린다.

## 가용성에 관계된 수치들

![image.png](2,3%EC%9E%A5%20270a3e9a6fbc800a9f35fc7e19a92077/image%202.png)

고가용성 : 시스템이 오랫동안 지속적으로 중단 없이 운영될 수 있는 능력

- 100% ⇒ 1번도 중단된 적이 없었음 (보통 99~100%)
- SLA(Service Level Agreement) 서비스 사업자와 고색사이에 맺어진 합의
    - 합의에는 가용시간(uptime)이 공식적으로 기술되어 있음
    - Google, Amazon 등에선 99% 이상의 SLA 제공

## 예제 : 트위터와 QPS와 저장소 요구량 추정

### 가정

- 월간 능동 이용자 (monthly active user)는 3억명이다.
- 50%사용자가 매일 트위터를 사용한다.
- 평균적으로 각 사용자는 매일 2건의 트윗을 올린다.
- 미디어를 포함하는 트윗은 10%이다.
- 데이터는 5년간 포관된다

### 추정 QPS(Query per Second)

- 일간 능동 사용자(Daily Active User) = 3억 * 50% = 1.5억
- QPS = 1.5억 * 2트윗 / 24시간 / 3600초 = 약 3500
- Peek QPS = 2 * QPS = 약 7000

미디어 저장을 위한 저장소 요구량 

- 평균 트윗 크기
    - tweet_id : 64byte
    - tweet_text : 140byte
    - tweet_media : 1MB
- 미디어 저장소 요구량 : 1.5억 * 2 * 10% * 1MB = 30TB
- 5년간 미디어를 보관하기 위한 저장소 요구량 = 30TB * 365 * 5 = 약 55PB

### 팁

![스크린샷 2025-09-16 오후 12.34.30.png](2,3%EC%9E%A5%20270a3e9a6fbc800a9f35fc7e19a92077/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2025-09-16_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_12.34.30.png)

AWS SLA EC2 

- 근사치를 활용한 계산 : 불필요한 계산에 시간 낭비하지 말기 99987 / 9 →100000 / 10 으로 하자.
- 가정들은 적어두기 → 나중에 살펴볼 수 있음
- 단위를 붙여라 : 단위를 안 적으면 추후에 헷갈리게 된다. 단위를 붙이는  습관을 들여라
- 많이 출제되는 계략적 규모 추정 문제: QPS, 최대 QPS, 저장소 요구량, 캐시 요구량 서버 수 등을 추정하는 것 → 미리미리 연습하기

# 3장 시스템 셀계 면접 공략법

## 시스템 설계 면접

두 명의 동료가 모호한 문제를 풀기 위해 협력하여 해결책을 찾아내는 과정에 대한 시뮬레이션

- 협력의 적당한 사람인가 ?
- 압박이 심한 상황에서도 잘 헤쳐 나갈 수 있는가 ?
- 모호한 문제를 건설적으로 해결할 수 있는지 ?

Red flag 사례 

- 설계의 순수성의 집착한 나머지 타협적 결정(trade off)을 도외시하고 과도한 엔지리어링을 하는 경우 → 시스템 전반의 비용 상승
- 완고함, 편협함 등

## 효과적 면접을 위한 4단계 접근법

### 1.  이해 및 설계 범위 확정

- 면접 질문이 들어올 때 요구사항을 완전히 이해하지 않고 답을 내놓는 행위는 아주 엄청난 RED FLAG
- 면접은 퀴즈쇼가 아니다. → 깊이 생각하고 요구사항과 가정들을 분명히 하라.
- 어려운 문제를 풀고 바로 최종설계를 내놓지 마라 → 잘못된 시스템을 설계하게 될 가능성이 높아진다.
- 가정을 하게 된다면 필기를 해놓아라.
- 면접관과 질문해라
    - 구체적으로 어떤 기능들을 만들어야하나?
    - 제품의 사용자 수 (DAU 등등) 얼마나 되나?
    - 회사의 규모는 얼마나 빨리 커지리라 예상하나? → 특정 기간뒤의 회사 규모는 얼마나 될 것 같은가?
    - 회사가 주로 사용하는 기술 스택은 무엇인가?
    - 설계를 단순화 하기 위해 활용할 수 잇는 기존 서비스로는 어떤 것들이 있는가 ?

### 2. 개략적인 설계한 제시 및 동의 구하기

개력적인 설계안을 제시하고 면접관의 동의를 얻는 과정. 해당 과정은 면접관과 협력하여 진행하는 것이 좋다. 

- 설계안에 대한 최초 청사진을 제시하고 의견을 구하라
- **면접관을 팀원처럼 대하라 → 질문에서 포함하는 범위와 의견에 대해서 질문하라**
- 화이트보드나 종이에 핵심 컴포넌트를 포함하는 다이어그램을 그려라 → 1장에서 배운 클라이언트, API, 웹서버, 데이터 저장소, 캐시, CDN, 메시지 큐 같은 것들이 포함될 수 있다.
- 계산 과정은 소리내어 설명하라.

![image.png](2,3%EC%9E%A5%20270a3e9a6fbc800a9f35fc7e19a92077/image%203.png)

### 3. 상세 설계

면접관과의 설계 대산 컴포넌트 사이의 우선순위를 정하는 것 

- 예시 1 : 단축 URL 설계
    - 함수의 설계를 구체적으로 설명하는 것을 주되게 해야한다.
- 예시 2: 채팅 시스템
    - 어떻게 해야 지연시간을 줄이고 사용자의 온/오프라인 상태를 표시할 지 표현해야한다.

**예제와 아키텍쳐 그림** 

1. 피드 발행
2. 뉴스 피드 가져오기

![image.png](2,3%EC%9E%A5%20270a3e9a6fbc800a9f35fc7e19a92077/image%204.png)

![image.png](2,3%EC%9E%A5%20270a3e9a6fbc800a9f35fc7e19a92077/image%205.png)

### 4. 마무리

마무리에 대한 지침 정리 

- 개선점은 언제나 있다. → 제시한 아키텍쳐가 절대 완벽하지 않음을 인지해라.
- 만든 설계를 요약해서 보여줘라. → 기억을 환기시켜주는 효과가 있다.
- 오류가 발생하면 어떻게 될 지 따져보아라
- 운영 이슈에 대해 논의해라 → 메트릭, 로그 수집은 어떻게 할지 , 시스템은 어떻게 배포할지 ?
- 확장 요구에 대해 어떻게 대처할 것인지 생각해라

**해야할 것** 

- 질문은 통해 확인해라 → 스스로 내린 가정이 옳다고 믿고 진행하지 마라.
- 문제의 요구사항을 이해하라
- 정답이나 최선의 답안 같은 것은 없다. 스타트업과 중견 기업을 위한 설계안이 같을리 없다. 요구사항을 확인해라.
- 면접관이 내 사고 호름을 읽을 수 있도록 소통하라
- 가능하다면 여러 해법을 함께 제시해라.
- 개략적 설꼐에 면접관이 동의하면 각 컴포넌트의 세부사항을 설명하기 시작하라. 가장 중요한 컴포넌트부터 진행하라.
- 면접관의 아이디어를 끌어내라. 좋은 면접관은 내 팀원이 되어줄 것이다.
- **포기하지마라**

하지말아야 할 것 

- 전형적인 면접 문제들에도 대비하지 않은 상태에서 면접장에 가지 말라
- 요구상이나 가정들이 분명하지 않은 상태에서 설계를 제시하지 말라
- 처음부터 특정 컴포넌트의 세부사항을 너무 깊이 설명하지 말라. 개략적 설계를 마친 뒹 ㅔ세부사항으로 나아가라
- 진행중에 막혓다면 힌트를 청하기를 주저하미 말라.
- 다시 말하지만 소통을 주저하지 말라. 침묵 속에서 설계를 진행하지 말라.
- 설계안을 내 놓은 순간 면접이 끝난다고 생각하지 말라. 면접관이 끝났다고 할때까지 끝난 것이 아니니 의견을 일찍 그리고 자주 구하라.